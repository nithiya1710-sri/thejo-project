<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Laser Source</title>

  <style>
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #030b1a;
      color: white;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    /* Header */
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: #002020;
      padding: 10px 20px;
      font-size: 16px;
      width: 100%;
      position: absolute;
      top: 0;
      left: 0;
    }

    /* CENTERED MAIN CONTAINER */
    .main {
      display: flex;
      justify-content: center;
      /* center horizontally */
      align-items: center;
      /* center vertically */
      width: 100%;
      max-width: 1200px;
      height: calc(100vh - 80px);
      padding: 20px;
      margin-top: 40px;
      background: #00111f;
      border-radius: 10px;
      gap: 20px;
      flex-wrap: wrap;
    }

    .left-panel {
      width: 65%;
    }

    /* Title bar */
    .panel-title {
      background: white;
      color: black;
      padding: 12px;
      display: flex;
      justify-content: space-between;
      font-weight: bold;
      cursor: pointer;
    }

    /* Blue wavelength panel */
    .panel.blue {
      background: #2fa7df;
      padding: 30px;
      color: white;
      font-size: 48px;
      text-align: center;
    }

    .mode-display,
    .power-display {
      font-size: 22px;
      font-weight: bold;
      margin-top: 15px;
    }

    /* Danger */
    .danger-panel {
      background: white;
      color: black;
      padding: 20px;
      text-align: center;
      margin-top: 10px;
    }

    .danger-title {
      font-size: 32px;
      color: red;
      font-weight: bold;
      display: flex;
      justify-content: center;
      gap: 10px;
    }

    /* Right button panel */
    .right-panel {
      width: 180px;
      background: #333;
      display: flex;
      flex-direction: column;
    }

    .right-panel button {
      padding: 20px;
      background: #444;
      color: white;
      border: none;
      cursor: pointer;
      border-bottom: 1px solid #555;
      font-size: 18px;
    }

    .right-panel button:hover {
      background: #555;
    }

    /* Blink animation */
    .blink-red {
      color: red;
      animation: blink 1s infinite;
    }

    @keyframes blink {
      0% {
        color: red;
      }

      50% {
        color: #2fa7df;
      }

      100% {
        color: red;
      }
    }

    /* Horizontal OTDR slider */
    .power-slider-container {
      width: 100%;
      text-align: center;
      margin-top: 20px;
      margin-bottom: 15px;
    }

    #powerSlider {
      -webkit-appearance: none;
      width: 95%;
      height: 6px;
      background: #6a7a89;
      border-radius: 10px;
      outline: none;
      cursor: pointer;
    }

    #powerSlider::-webkit-slider-runnable-track {
      height: 6px;
      background: #6a7a89;
      border-radius: 10px;
    }

    #powerSlider::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 20px;
      height: 20px;
      background: #8dc7f7;
      border-radius: 5px;
      margin-top: -7px;
    }
  </style>
</head>

<body>

  <!-- HEADER -->
  <div class="header">
    <span class="title">Laser Source</span>
    <span id="timestamp"></span>

  </div>

  <!-- MAIN CENTERED PANEL -->
  <div class="main">

    <!-- LEFT PANEL -->
    <div class="left-panel">

      <div class="panel-title">
        <span>Laser Source</span>
        <span id="status-text">OFF</span>
      </div>

      <div class="panel blue">
        <div>
          <span id="laser-icon">☀</span>
          <span class="value">1550</span> nm
        </div>

        <div class="mode-display">Mode: <span id="modeValue">CW</span></div>
        <div class="power-display">Power: <span id="powerValue">10</span> dBm</span></div>
      </div>

      <div class="danger-panel">
        <div class="danger-title">
          <span>☀</span><span>DANGER</span>
        </div>
        <p>Looking directly at laser output<br>may cause damage to human eyes!</p>
      </div>

      <!-- CENTERED SLIDER -->
      <div class="power-slider-container">
        <input type="range" id="powerSlider" min="0" max="30" value="10">
      </div>

    </div>

    <!-- RIGHT PANEL -->
    <div class="right-panel">
      <button id="open-btn">Open</button>
      <button id="wave-btn">Wave</button>
      <button id="mode-btn">Mode</button>
      <button id="power-plus">Power +</button>
      <button id="power-minus">Power -</button>
      <button onclick="window.location.href='home.html'">Exit</button>
    </div>

  </div>

  <!-- JAVASCRIPT -->
  <script>

    /* Clock */
    const timestamp = document.getElementById("timestamp");
    function updateClock() {
      const now = new Date();
      timestamp.textContent =
        `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, "0")}-${String(now.getDate()).padStart(2, "0")}`
        + " " + now.toLocaleTimeString();
    }
    setInterval(updateClock, 1000);
    updateClock();

    /* Elements */
    const statusText = document.getElementById("status-text");
    const laserIcon = document.getElementById("laser-icon");
    const waveValue = document.querySelector(".value");

    const openBtn = document.getElementById("open-btn");
    const waveBtn = document.getElementById("wave-btn");
    const modeBtn = document.getElementById("mode-btn");
    const plusBtn = document.getElementById("power-plus");
    const minusBtn = document.getElementById("power-minus");
    const powerSlider = document.getElementById("powerSlider");

    const modeValue = document.getElementById("modeValue");
    const powerValue = document.getElementById("powerValue");

    /* States */
    let isLaserOn = false;
    let wave1310 = false;
    let modeIndex = 0;
    const modes = ["CW", "270 Hz", "330 Hz", "1000 Hz", "2000 Hz"];
    let powerLevel = 10;

    /* Laser Open/Close */
    openBtn.addEventListener("click", () => {
      isLaserOn = !isLaserOn;

      if (isLaserOn) {
        statusText.textContent = "CW";
        modeValue.textContent = "CW";
        openBtn.textContent = "Close";
        laserIcon.classList.add("blink-red");
      } else {
        statusText.textContent = "OFF";
        openBtn.textContent = "Open";
        laserIcon.classList.remove("blink-red");
        modeIndex = 0;
        modeValue.textContent = "CW";
      }
    });

    /* Wavelength */
    waveBtn.addEventListener("click", () => {
      wave1310 = !wave1310;
      waveValue.textContent = wave1310 ? "1310" : "1550";
    });

    /* Mode */
    modeBtn.addEventListener("click", () => {
      if (!isLaserOn) return;
      modeIndex = (modeIndex + 1) % modes.length;
      modeValue.textContent = modes[modeIndex];
      statusText.textContent = modes[modeIndex];
    });

    /* Power Slider */
    powerSlider.addEventListener("input", () => {
      if (!isLaserOn) return;
      powerLevel = parseInt(powerSlider.value);
      powerValue.textContent = powerLevel;
    });

    /* Power+ */
    plusBtn.addEventListener("click", () => {
      if (!isLaserOn) return;
      if (powerLevel < 30) {
        powerLevel++;
        powerSlider.value = powerLevel;
        powerValue.textContent = powerLevel;
      }
    });

    /* Power- */
    minusBtn.addEventListener("click", () => {
      if (!isLaserOn) return;
      if (powerLevel > 0) {
        powerLevel--;
        powerSlider.value = powerLevel;
        powerValue.textContent = powerLevel;
      }
    });

  </script>
  <script>
    /* -------------------- BRIGHTNESS CONTROL -------------------- */
    const brightnessMap = {
      '0%': 0,
      '20%': 0.2,
      '40%': 0.4,
      '60%': 0.6,
      '80%': 0.8,
      '100%': 1
    };
    const savedBrightness = localStorage.getItem('brightness') || '100%';
    document.body.style.filter = `brightness(${brightnessMap[savedBrightness] || 1})`;

    /* -------------------- LANGUAGE TRANSLATIONS -------------------- */
    const translations = {
      en: {
        title: "Laser Source",
        open: "Open",
        close: "Close",
        wave: "Wave",
        mode: "Mode",
        powerPlus: "Power +",
        powerMinus: "Power -",
        exit: "Exit",
        danger: "DANGER",
        warning: "Looking directly at laser output\nmay cause damage to human eyes!",
        cw: "CW",
        off: "OFF"
      },
      fr: {
        title: "Source Laser",
        open: "Ouvrir",
        close: "Fermer",
        wave: "Longueur d’onde",
        mode: "Mode",
        powerPlus: "Puissance +",
        powerMinus: "Puissance -",
        exit: "Quitter",
        danger: "DANGER",
        warning: "Regarder directement le laser\npeut endommager les yeux humains !",
        cw: "CW",
        off: "ARRÊT"
      },
      es: {
        title: "Fuente Láser",
        open: "Abrir",
        close: "Cerrar",
        wave: "Longitud de onda",
        mode: "Modo",
        powerPlus: "Potencia +",
        powerMinus: "Potencia -",
        exit: "Salir",
        danger: "PELIGRO",
        warning: "Mirar directamente al láser\npuede dañar los ojos humanos.",
        cw: "CW",
        off: "APAGADO"
      },
      de: {
        title: "Laserquelle",
        open: "Öffnen",
        close: "Schließen",
        wave: "Wellenlänge",
        mode: "Modus",
        powerPlus: "Leistung +",
        powerMinus: "Leistung -",
        exit: "Beenden",
        danger: "GEFAHR",
        warning: "Direkter Blick in den Laser\nkann Augenschäden verursachen!",
        cw: "CW",
        off: "AUS"
      },

      it: {
        title: "Sorgente Laser",
        open: "Apri",
        close: "Chiudi",
        wave: "Lunghezza d'onda",
        mode: "Modalità",
        powerPlus: "Potenza +",
        powerMinus: "Potenza -",
        exit: "Esci",
        danger: "PERICOLO",
        warning: "Guardare direttamente il laser\npuò danneggiare gli occhi!",
        cw: "CW",
        off: "SPENTO"
      },

      pt: {
        title: "Fonte Laser",
        open: "Abrir",
        close: "Fechar",
        wave: "Comprimento",
        mode: "Modo",
        powerPlus: "Potência +",
        powerMinus: "Potência -",
        exit: "Sair",
        danger: "PERIGO",
        warning: "Olhar diretamente para o laser\npode causar danos aos olhos!",
        cw: "CW",
        off: "DESLIGADO"
      },

      nl: {
        title: "Laserbron",
        open: "Openen",
        close: "Sluiten",
        wave: "Golflengte",
        mode: "Modus",
        powerPlus: "Vermogen +",
        powerMinus: "Vermogen -",
        exit: "Afsluiten",
        danger: "GEVAAR",
        warning: "Rechtstreeks in de laser kijken\nkan oogschade veroorzaken!",
        cw: "CW",
        off: "UIT"
      }
    };

    /* --------- APPLY LANGUAGE --------- */
    const lang = localStorage.getItem("language") || "en";
    const t = translations[lang] || translations.en;

    document.querySelector(".title").textContent = t.title;
    document.getElementById("wave-btn").textContent = t.wave;
    document.getElementById("mode-btn").textContent = t.mode;
    document.getElementById("power-plus").textContent = t.powerPlus;
    document.getElementById("power-minus").textContent = t.powerMinus;
    document.querySelector(".right-panel button:last-child").textContent = t.exit;
    document.querySelector(".danger-title span:last-child").textContent = t.danger;

    /* Fix missing class warning-text */
    const warn = document.querySelector(".danger-panel p");
    if (warn) warn.textContent = t.warning;

    /* --------- UPDATE BUTTON TEXT BASED ON LASER STATE --------- */
    function updateOpenButtonLabel() {
      openBtn.textContent = isLaserOn ? t.close : t.open;
      statusText.textContent = isLaserOn ? t.cw : t.off;
    }

    /* Patch into existing logic */
    updateOpenButtonLabel();

    openBtn.addEventListener("click", () => {
      setTimeout(updateOpenButtonLabel, 10);
    });
  </script>


</body>

</html>
